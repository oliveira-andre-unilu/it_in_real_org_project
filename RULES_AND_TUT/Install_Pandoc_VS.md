# Pandoc Installation Guide for Windows and macOS with VS Code

*File partially generated by AI so be careful*

## Overview
This guide covers installing Pandoc to convert Markdown documents with LaTeX snippets to PDF, configured to work with VS Code.

---

## Windows Installation

### Step 1: Install Pandoc
1. **Download Pandoc**
   - Go to [Pandoc download page](https://pandoc.org/installing.html)
   - Download the **Windows 64-bit installer**

2. **Run the Installer**
   - Follow the installation wizard
   - Use default settings
   - Ensure "Add pandoc to PATH" is selected

### Step 2: Install MiKTeX (Required for PDF generation)
Follow the same MiKTeX installation steps from the LaTeX guide, including **Strawberry Perl**.

### Step 3: Verify Installation
Open Command Prompt and test:
```cmd
pandoc --version
pdflatex --version
```

---

## macOS Installation

### Step 1: Install Pandoc

**Option A: Using Installer (Recommended)**
1. Download from [Pandoc download page](https://pandoc.org/installing.html)
2. Run the macOS .pkg installer

**Option B: Using Homebrew**
```bash
brew install pandoc
```

### Step 2: Install MacTeX
Follow the same MacTeX installation steps from the LaTeX guide.

### Step 3: Verify Installation
Open Terminal and test:
```bash
pandoc --version
pdflatex --version
```

---

## VS Code Setup (Both Platforms)

### Step 1: Install VS Code Extensions
1. **Install Pandoc Extension**
   - Search for "Pandoc" in Extensions
   - Install "Pandoc Preview" by Brian Zickau

2. **Recommended Markdown Extensions**
   - "Markdown All in One" by Yu Zhang
   - "Markdown Preview Enhanced" by Yiyi Wang
   - "Pandoc Citer" by notZaki (if you need citations)

### Step 2: Configure VS Code Settings (NOT NEEDED)

**Add to your `settings.json`:**

```json
{
    // Pandoc Configuration
    "pandoc.pdfOptString": "--pdf-engine=xelatex --toc --number-sections --highlight-style=tango",
    "pandoc.htmlOptString": "--self-contained --toc --number-sections --css=github-pandoc.css",
    "pandoc.docxOptString": "--reference-doc=reference.docx --toc --number-sections",
    
    // Markdown Configuration
    "markdown.preview.doubleClickToSwitchToEditor": false,
    
    // Task Configuration for Pandoc
    "tasks": []
}
```

### Step 3: Create VS Code Tasks for Pandoc (NOT NEEDED)

Create a `.vscode/tasks.json` file in your project:

```json
{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Pandoc: Convert to PDF",
            "type": "shell",
            "command": "pandoc",
            "args": [
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}.pdf",
                "--pdf-engine=xelatex",
                "--toc",
                "--number-sections",
                "--highlight-style=tango",
                "-V",
                "geometry:margin=1in",
                "-V",
                "colorlinks=true",
                "--template",
                "eisvogel",
                "--listings"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            }
        },
        {
            "label": "Pandoc: Convert to HTML",
            "type": "shell",
            "command": "pandoc",
            "args": [
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}.html",
                "--self-contained",
                "--toc",
                "--number-sections",
                "--css=github-pandoc.css",
                "--highlight-style=tango"
            ],
            "group": "build"
        }
    ]
}
```

---

## Creating Pandoc Templates and Styles (Useful tips to create new templates)

### Step 1: Create a Default Template (Optional)
Generate a default template to customize:
```bash
pandoc -D latex > custom-template.tex
```

### Step 2: Create a YAML Metadata Block
Create a sample Markdown file with YAML header:

```yaml
---
title: "Your Document Title"
author: "Your Name"
date: \today
geometry: "margin=1in"
fontsize: 11pt
documentclass: article
classoption: oneside
header-includes:
  - \usepackage{amsmath}
  - \usepackage{amssymb}
  - \usepackage{xcolor}
  - \definecolor{codebg}{RGB}{240,240,240}
  - \usepackage{listings}
  - \lstset{backgroundcolor=\color{codebg}, basicstyle=\ttfamily\small}
toc: true
number-sections: true
---
```

### Step 3: Create CSS for HTML Output (Optional)
Create `github-pandoc.css` for HTML styling.

---

## Testing Your Pandoc Setup

### Step 1: Create a Test Markdown File
Create `test-document.md`:

```markdown
---
title: "Pandoc Test Document"
author: "Your Name"
date: \today
geometry: "margin=1in"
classoption: oneside
header-includes:
  - \usepackage{amsmath}
  - \usepackage{amssymb}
toc: true
number-sections: true
---

# Introduction

This is a **test document** demonstrating Pandoc with LaTeX snippets.

## Mathematical Content

Here's some inline math: $E = mc^2$ and some display math:

$$
\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
$$

### Matrix Example

\begin{equation}
A = \begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
\end{equation}

## Code Listing

We can also include code blocks with syntax highlighting:

```python
def hello_world():
    print("Hello from Pandoc!")
    return True
```

## References and Citations

You can cite sources too [@example2023].

## Table Example

```

| Column 1 | Column 2 | Column 3 |
|----------|----------|----------|
| Data A   | Data B   | Data C   |
| Data X   | Data Y   | Data Z   |

```

---

## References

```
::: {#refs}
:::
```

### Step 2: Convert to PDF (first option)
Run in terminal:
```bash
#without styling
pandoc test-document.md -o test-document.pdf

#using some specific engines
pandoc test-document.md -o test-document.pdf --pdf-engine=xelatex --toc --number-sections --highlight-style=tango -V geometry:margin=1in -V colorlinks=true
```
 
### Step 3: Use VS Code Task (second option)
1. Open your Markdown file in VS Code
2. Press `Ctrl+Shift+P` â†’ "Tasks: Run Build Task"
3. Select "Pandoc: Convert to PDF"

---

## Advanced Pandoc Configuration

### Create a Makefile for Complex Projects
Create `Makefile`:

```makefile
# Makefile for Pandoc documents
MD_FILES = $(wildcard *.md)
PDF_FILES = $(MD_FILES:.md=.pdf)
HTML_FILES = $(MD_FILES:.md=.html)

# Pandoc options
PDF_OPTS = --pdf-engine=xelatex --toc --number-sections --highlight-style=tango -V geometry:margin=1in -V colorlinks=true --template eisvogel
HTML_OPTS = --self-contained --toc --number-sections --css=github-pandoc.css --highlight-style=tango

# Default target
all: pdf

# PDF target
pdf: $(PDF_FILES)

# HTML target
html: $(HTML_FILES)

# Pattern rule for PDF
%.pdf: %.md
	pandoc $< -o $@ $(PDF_OPTS)

# Pattern rule for HTML
%.html: %.md
	pandoc $< -o $@ $(HTML_OPTS)

# Clean up
clean:
	rm -f $(PDF_FILES) $(HTML_FILES)

.PHONY: all pdf html clean
```

### VS Code Snippets for Markdown + LaTeX
Create `.vscode/markdown-latex.code-snippets`:

```json
{
    "Latex Equation": {
        "prefix": "eq",
        "body": [
            "$$",
            "$1",
            "$$",
            "$0"
        ],
        "description": "Insert LaTeX equation block"
    },
    "Latex Inline Math": {
        "prefix": "math",
        "body": [
            "$$1$ $0"
        ],
        "description": "Insert inline LaTeX math"
    },
    "Pandoc YAML Header": {
        "prefix": "yaml-header",
        "body": [
            "---",
            "title: \"${1:Document Title}\"",
            "author: \"${2:Your Name}\"",
            "date: \\today",
            "geometry: \"margin=1in\"",
            "fontsize: ${3|10pt,11pt,12pt|}",
            "documentclass: ${4|article,report,book|}",
            "classoption: ${5|oneside,twoside|}",
            "header-includes:",
            "  - \\usepackage{amsmath}",
            "  - \\usepackage{amssymb}",
            "  - \\usepackage{xcolor}",
            "toc: true",
            "number-sections: true",
            "---",
            "$0"
        ],
        "description": "Insert Pandoc YAML metadata block"
    }
}
```

---

## Troubleshooting

### Common Pandoc Issues

1. **"pdflatex not found"**
   - Ensure MiKTeX/MacTeX is properly installed
   - Restart VS Code after LaTeX installation

2. **Font issues in PDF**
   - Use `--pdf-engine=xelatex` instead of pdflatex
   - Add font options: `-V mainfont="Arial" -V sansfont="Arial"`

3. **Template not found**
   - Download templates from: https://github.com/Wandmalfarbe/pandoc-latex-template
   - Place in: `~/.pandoc/templates/` (macOS/Linux) or `%APPDATA%\pandoc\templates` (Windows)

4. **Code highlighting not working**
   - Install highlighting styles: `pandoc --list-highlight-styles`
   - Use available styles: pygments, tango, espresso, etc.

### VS Code Integration Issues

1. **Tasks not running**
   - Ensure tasks.json is in `.vscode/` folder
   - Check file paths in task definitions

2. **Pandoc command not found in VS Code**
   - Restart VS Code after Pandoc installation
   - Check PATH environment variable

---

## Useful Commands

### Common Pandoc Conversions
```bash
# Markdown to PDF with LaTeX
pandoc input.md -o output.pdf --pdf-engine=xelatex --toc --number-sections

# Markdown to HTML
pandoc input.md -o output.html --self-contained --toc --css=style.css

# Markdown to Word
pandoc input.md -o output.docx --reference-doc=template.docx

# With custom template
pandoc input.md -o output.pdf --template=eisvogel --pdf-engine=xelatex
```

### Useful Pandoc Flags
- `--toc` - Include table of contents
- `--number-sections` - Number sections automatically
- `--highlight-style=style` - Code highlighting style
- `--pdf-engine=engine` - Specify PDF engine (xelatex, pdflatex, lualatex)
- `--listings` - Use LaTeX listings package for code
- `--filter=pandoc-citeproc` - Process citations (if using references)

This setup provides a complete workflow for converting Markdown documents with LaTeX snippets to beautifully formatted PDFs using Pandoc and VS Code.